<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="Agu140">
    <title>Nombre de la actividad</title>
    <link rel="icon" type="image/x-icon" href="https://iesventura.es/_ies_datos/LOGO_new.jpg">
    <link rel="stylesheet" href="estilos.css">
</head>
<body>
    <script>
        /*
        Cada uno de nosotros hereda de sus padres biológicos un conjunto de 
        instrucciones químicas conocidas como ADN que influyen en cómo se 
        construye su cuerpo. Toda la vida conocida depende del ADN.

        El ADN es una cadena larga de otras sustancias químicas y las más 
        importantes son los cuatro nucleótidos: adenina, citosina, guanina 
        y timina. Una sola cadena de ADN puede contener miles de millones 
        de estos cuatro nucleótidos y el orden en el que aparecen es 
        importante. Llamamos "secuencia de ADN" al orden de estos nucleótidos 
        en un fragmento de ADN.

        Representamos una secuencia de ADN como una colección ordenada de estos 
        cuatro nucleótidos y una forma común de hacerlo es con una cadena de 
        caracteres como "ATTACG" para una secuencia de ADN de 6 nucleótidos. 
        “A" para adenina, "C" para citosina, "G" para guanina y "T" para 
        timina.

        Se pide:

        Crear la función cuentaNucleotidos con las siguientes especificaciones:

        Recibe un array de caracteres los cuales representan una secuencia de ADN.
        Contar cuántos de cada nucleótido están presentes en dicho array. Si la 
        secuencia contiene caracteres que no son A, C, G o T, entonces no es válida 
        y debe devolver una cadena de caracteres con el mensaje de error: 
        'Error: Secuencia de ADN no válida. Sólo debe contener 'A', 'C', 'G' o 'T'.'

        En caso de ser válida, la función debe devolver un objeto de tipo Map donde 
        la clave corresponde al nucleótido y el valor a la cantidad de estos 
        encontrada en la secuencia estudiada.
        
        Ejemplo:

        secuenciaValida = ['G', 'T', 'T', 'A', 'C', 'A']; 
        secuenciaNoValida = ['A','T','G','G','C','T','T','A','I','G'];

        cuentaNucleotidos(secuenciaValida) //Map(4){'A'=>2,'C'=>1,'G'=>1,'T'=>2}

        cuentaNucleotidos(secuenciaNoValida) //Error: Secuencia de ADN no válida. 
        Sólo debe contener 'A', 'C', 'G' o 'T'.

        Convertir la función del Ejercicio 1 en una función autoejecutable. Al cargar
        la página la función se debe realizar el conteo de los nucleótidos del array 
        que se pasa por parámetro.

        Mostrar en el lado del cliente (mediante document.write) los resultados del estudio. 
        Por ejemplo, pasando a la función autoejecutable la secuencia: 

        ['A','T','G','C','T','T','C','A','G','A','A','A'], se debe visualizar: 

        A => 5

        C => 2 

        G => 2 

        T => 3
        */

        // Primero creamos los dos arrays a modo de demo que nuestro script probara.
        let secuenciaDemo1 = ["A", "G", "A", "C", "T", "A", "C"];
        let secuenciaDemo2 = ["A", "G", "A", "S", "T", "A", "C"];

        // Creamos las letiable que "true", es valida, "false" no lo es.
        verificarSecuenciaValida(secuenciaDemo1);

        /**
         * Método / función que imprime el mapa con los indices
         * actualizados y contados de todos los nucleotidos en
         * una secuencia valida de ADN.´
         * 
         * @param {Map<string, number>} mapaValido
        */
       function imprimirMapa(mapaValido) {

            mapaValido.forEach((cantidad, nucleotido) => {
                
                document.write("<p>"+ nucleotido + " => "+ cantidad + "</p><br>");
                
            });
       }

        /**
         * Función / método que verifica si una secuencia es valida o no.
         * 
         * @param {string[]} secuencia 
         */
        function verificarSecuenciaValida (secuencia) {
            // De entrada es supuestamente "valida" hasta que se demuestre lo contrario.
            let resultado = true;

            // Recorremos el array una por una sus posiciones, si encontramos algo diferente a "A", "G", "C" o "T" devuelve false.
            for (posicion = 0; posicion < secuencia.length; posicion++) {
                // Verificamos una a una las pisiciones con charAt y un if algo largo..
                if (secuencia[posicion] !== "A" && secuencia[posicion] !== "C" && secuencia[posicion] !== "G" && secuencia[posicion] !== "T") {
                    document.write("¡Error! La secuencia solo puede contener \"A\", \"G\", \"C\" o \"T\"<br>");
                    resultado = false;
                }
            }    

            if (resultado) {
                cuentaNucleotidos(secuencia);
            }
        }

        /**
         * Función / Método que cuenta los nucleotidos en una secuencia de ADN
         * valida.
         * 
         * @param {string[]} secuencia 
         */
        function cuentaNucleotidos(secuencia) {
            // Creamo un nuevo mapa al que, ahora, le diremos sus indices.
            /**
             * @type {Map<string, number>}
             */
            let nuevoMapa = new Map();

            // Creamos los indices para los 4 nucleotidos con valor "0".
            nuevoMapa.set("A", 0);
            nuevoMapa.set("C", 0);
            nuevoMapa.set("G", 0);
            nuevoMapa.set("T", 0);

            // Bucle que recorre una por una todas las posiciones de un array.
            for (posicion = 0; posicion < secuencia.length; posicion++) {
                // Guardamos en una letiable el nucleotido en la posiº<ción actual del array.
                let nucleotido = secuencia[posicion];

                // Si existe ese "nucleotido" dentro de la secuencia, obtiene su valor actual en el mapa y lo incrementa "1".
                if (nuevoMapa.has(nucleotido)) {
                    nuevoMapa.set(nucleotido, nuevoMapa.get(nucleotido) +1);
                }

            }

            imprimirMapa(nuevoMapa);
        }
    </script>
</body>
</html>